:root{
  --bg:#f6f8ff;
  --panel:rgba(255,255,255,.9);
  --card:#ffffff;
  --text:#0f172a;
  --muted:#475569;
  --border:#e2e8f0;
  --primary:#2563eb;
  --success:#16a34a;
  --danger:#dc2626;
  --shadow:0 10px 28px rgba(15,23,42,.08);
}
*{box-sizing:border-box}
body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,"PingFang SC","Microsoft YaHei",Arial;color:var(--text);background:linear-gradient(180deg,var(--bg),#eef2ff)}
a{color:var(--primary);text-decoration:none}
.topbar{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-bottom:1px solid var(--border);background:var(--panel);position:sticky;top:0;backdrop-filter: blur(10px);z-index:10}
.topbar a{color:var(--text)}
.brand a{font-weight:700}
.top-actions{display:flex;gap:12px;align-items:center}
.layout{display:flex;min-height:calc(100vh - 54px)}
.sidebar{width:220px;flex:0 0 220px;border-right:1px solid var(--border);background:var(--panel);position:sticky;top:54px;height:calc(100vh - 54px);overflow:auto;padding:12px}
.menu{display:flex;flex-direction:column;gap:6px}
.menu-item{display:block;padding:10px 10px;border-radius:10px;color:var(--text);border:1px solid transparent}
.menu-item:hover{background:#eef2ff;border-color:rgba(37,99,235,.15)}
.menu-title{font-size:12px;color:var(--muted);margin:8px 10px 0}
.menu-sep{height:1px;background:var(--border);margin:10px 0}
.container{max-width:none;width:100%;flex:1;margin:18px 12px;padding:0 12px}
.card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:14px;margin:12px 0;box-shadow:var(--shadow)}
.narrow{max-width:420px;margin:40px auto}
.muted{color:var(--muted);font-size:12px}
.hint{color:var(--muted);font-size:12px;margin-top:10px}
.alert{border:1px solid rgba(220,38,38,.35);background:rgba(220,38,38,.06);padding:10px;border-radius:10px;margin:10px 0}
.btn{border:1px solid var(--border);background:#f1f5f9;color:var(--text);padding:8px 10px;border-radius:10px;cursor:pointer;display:inline-flex;align-items:center;gap:6px}
.btn:hover{background:#e2e8f0}
.btn.primary{border-color:rgba(37,99,235,.35);background:rgba(37,99,235,.1)}
.btn.success{border-color:rgba(22,163,74,.35);background:rgba(22,163,74,.1)}
.btn.success:hover{background:rgba(22,163,74,.16)}
.btn.danger{border-color:rgba(220,38,38,.35);background:rgba(220,38,38,.08)}
.btn.small{padding:6px 8px;border-radius:9px;font-size:12px}
.actions{display:flex;gap:10px;align-items:center;margin:10px 0}
.date-input{width:160px}
.month-input{width:140px}
.inline{display:inline}
.linkbtn{background:none;border:none;color:var(--text);cursor:pointer;padding:0}
.form{display:flex;flex-direction:column;gap:10px}
input,select,textarea{width:100%;padding:8px 10px;border-radius:10px;border:1px solid var(--border);background:#fff;color:var(--text);outline:none}
textarea{resize:vertical}
label{font-size:12px;color:var(--muted)}
.table{width:100%;border-collapse:collapse}
.table th,.table td{border:1px solid var(--border);padding:8px;vertical-align:top}
.table th{background:#f1f5f9;position:relative;text-align:left}
.table.sticky th{position:sticky;top:52px;z-index:1}
.plan-table{table-layout:fixed;background:#fff}
.plan-table th{background:#f8fafc}
.plan-table th.col-cat,.plan-table td.col-cat{width:180px}
.plan-table th.col-sub,.plan-table td.col-sub{width:180px}
.plan-table th.col-goal,.plan-table td.col-goal{width:260px}
.plan-table th.col-detail,.plan-table td.col-detail{width:360px}
.plan-table th.col-actions,.plan-table td.col-actions{width:140px}
.plan-table th.col-progress,.plan-table td.col-progress{width:220px}
.plan-table th.col-estimated,.plan-table td.col-estimated{width:120px;text-align:right}
.plan-table th.col-total,.plan-table td.col-total{width:120px;white-space:nowrap;text-align:right}
.plan-table .progress-box{flex-wrap:wrap;gap:8px}
.plan-table .progress-box select{width:110px}
.plan-table .progress-box input{max-width:140px}
.plan-table input[type=number]{max-width:140px}
.plan-table .cell-view{min-height:36px;white-space:pre-wrap;word-break:break-word;line-height:1.35}
.plan-table .cell-pre{white-space:pre-wrap;word-break:break-word}
.plan-table .cell-num{text-align:right;font-variant-numeric:tabular-nums}
.plan-table .cell-edit{display:none}
.plan-table tr.is-editing .cell-edit{display:block}
.plan-table tr.is-editing .cell-view{display:none}
.plan-table .row-actions{display:flex;gap:8px;align-items:center;flex-wrap:nowrap}
.plan-table .row-actions form{margin:0}
.plan-table .dict-field .dict-input{min-width:0}
.row{display:flex;gap:12px}
.col{flex:1}
.rowform{display:flex;gap:10px;align-items:flex-start}
.rowform input,.rowform select{min-width:150px}
.dict-field{display:flex;gap:8px;align-items:center;width:100%}
.dict-field .dict-input{flex:1;min-width:170px}
.grid{display:grid;grid-template-columns:160px 1fr;gap:10px;align-items:center}
.actions-col{white-space:nowrap}
.progress-box{display:flex;gap:8px}
.progress-box select{width:96px}
.detail-actions{margin-top:6px}
.dialog{border:1px solid var(--border);border-radius:14px;max-width:880px;width:90%;background:var(--card);color:var(--text);box-shadow:var(--shadow)}
.dialog-large{max-width:96%;width:96%;}
.dialog-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}
.dialog-actions{display:flex;gap:8px;align-items:center}
.dialog::backdrop{background:rgba(15,23,42,.35)}
.dialog-inner{padding:14px}
.detail-row{display:grid;grid-template-columns:1fr 120px 80px;gap:8px;margin:8px 0}
.list{margin:0;padding-left:18px}
.plan-frame{width:100%;height:72vh;border:1px solid var(--border);border-radius:10px}
.embed-container{max-width:none;width:100%;margin:12px 8px;padding:0 12px}

.cards{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:16px;margin-top:12px}
.week-card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:14px;box-shadow:var(--shadow)}
.week-card.current{position:relative;border:2px solid rgba(37,99,235,.55);background:linear-gradient(180deg,rgba(37,99,235,.10),var(--card) 62%);box-shadow:0 14px 34px rgba(37,99,235,.18)}
.week-card.current::before{content:"";position:absolute;left:-2px;top:-2px;bottom:-2px;width:6px;background:rgba(37,99,235,.65);border-radius:14px 0 0 14px;pointer-events:none}
.week-card h3{margin:0 0 8px;font-size:16px}
.week-meta{display:flex;flex-direction:column;gap:6px}
.week-actions{display:flex;gap:10px;align-items:center;margin-top:12px;flex-wrap:wrap}
.week-actions .btn{width:112px;height:36px;justify-content:center;white-space:nowrap}
.status-badge{font-weight:700}
.status-ok{color:var(--success)}
.status-bad{color:var(--danger)}

.email-config-card{padding:18px}
.email-config-form{display:grid;grid-template-columns:220px 1fr;gap:10px 14px;align-items:center}
.email-config-form .hint{grid-column:1/-1;margin:0}
.email-config-form button{grid-column:1/-1;justify-self:start}

@media (max-width: 860px){
  .email-config-form{grid-template-columns:1fr;align-items:stretch}
}

@media (max-width: 860px){
  .layout{flex-direction:column}
  .sidebar{position:relative;top:0;width:auto;flex:0 0 auto;height:auto;border-right:none;border-bottom:1px solid var(--border)}
  .container{margin:12px auto}
}
